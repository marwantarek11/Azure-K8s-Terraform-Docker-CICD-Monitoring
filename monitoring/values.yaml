# Default values for monitoring stack
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Prometheus configuration
kube-prometheus-stack:
  prometheus:
    service:
      type: LoadBalancer
      port: 9090
    prometheusSpec:
      retention: 30d
      storageSpec:
        volumeClaimTemplate:
          spec:
            accessModes: ["ReadWriteOnce"]
            resources:
              requests:
                storage: 50Gi
  alertmanager:
    enabled: true
    service:
      type: LoadBalancer
      port: 9093
  grafana:
    enabled: false  # Disable built-in Grafana since we use separate Grafana chart

# Grafana configuration
grafana:
  adminPassword: admin  # Change this in production
  service:
    type: LoadBalancer
    port: 3000
  persistence:
    enabled: true
    size: 10Gi
  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
      - name: Prometheus
        type: prometheus
        url: http://monitoring-kube-prometheus-prometheus:9090
        access: proxy
        isDefault: true
  dashboardProviders:
    dashboardproviders.yaml:
      apiVersion: 1
      providers:
      - name: 'default'
        orgId: 1
        folder: ''
        type: file
        disableDeletion: false
        updateIntervalSeconds: 10
        allowUiUpdates: true
        options:
          path: /var/lib/grafana/dashboards/default
  dashboards:
    default:
      kubernetes-cluster-monitoring:
        gnetId: 3119
        revision: 1
        datasource: Prometheus
      node-exporter-full:
        gnetId: 1860
        revision: 36
        datasource: Prometheus
      prometheus-2-0-overview:
        gnetId: 3662
        revision: 2
        datasource: Prometheus

# ServiceMonitor configuration
serviceMonitor:
  enabled: true
  namespace: default  # Namespace where the microservice is deployed
  interval: 30s
  scrapeTimeout: 10s
